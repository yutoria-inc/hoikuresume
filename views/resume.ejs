<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>ホイクレジュメ | 職務経歴書自動作成</title>
    <meta
      name="description"
      content="保育士転職向けの職務経歴書を、Web上で入力するだけで自動作成できます。PDFでダウンロードしてそのまま応募に使えます。"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
    /* ───────── 1. ROOT VARIABLES ───────── */
    :root {
      --primary: #0f766e;
      --primary-soft: #e0f2f1;
      --accent: #0f766e;
      --border: #e5e7eb;
      --bg: #f3f4f6;
      --card-bg: #ffffff;
      --text-main: #111827;
      --text-sub: #6b7280;
      --danger: #ef4444;
    }

    /* ───────── 2. RESET / BASE ───────── */

    * {
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      max-width: 1100px;
      margin: 0 auto;
      padding: 24px 16px 40px;
      background: radial-gradient(circle at top left, #eef2ff 0, #f3f4f6 40%, #f9fafb 100%);
      color: var(--text-main);
    }

    /* ───────── 3. COMMON HEADER ───────── */

    .site-header {
      display: flex;
      align-items: center;
      height: 56px;
      margin-bottom: 24px;
    }

    .site-header a {
      color: var(--text-main);
      text-decoration: none;
    }

    .site-header a:hover {
      opacity: 0.8;
    }

    .site-logo {
      font-weight: 700;
      font-size: 20px;
      letter-spacing: 0.12em;
      display: inline-block;
      padding: 6px 4px;
    }

    /* ───────── 4. PAGE CONTAINER ───────── */

    .page {
      border-radius: 18px;
      padding: 28px 24px 32px;
      background: var(--card-bg);
      box-shadow: 0 20px 45px rgba(15, 23, 42, 0.10),
                  0 1px 0 rgba(255, 255, 255, 0.6) inset;
    }

    .page-title {
      font-size: 22px;
      font-weight: 700;
      text-align: center;
      margin-bottom: 18px;
      letter-spacing: 0.04em;
    }

    /* ───────── 5. STEPPER ───────── */

    .stepper-container {
      margin-bottom: 20px;
    }

    .stepper-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 6px;
      color: var(--text-sub);
    }

    .stepper {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      padding: 10px 12px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 999px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.08);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
    }

    .stepper::before {
      content: '';
      position: absolute;
      left: 40px;
      right: 40px;
      top: 24px;
      height: 2px;
      background: #e5e7eb;
      z-index: 0;
    }

    .step {
      position: relative;
      z-index: 1;
      flex: 1;
      text-align: center;
      cursor: pointer;
    }

    .step-circle {
      width: 26px;
      height: 26px;
      margin: 0 auto 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 999px;
      border: 2px solid #d1d5db;
      background: #f9fafb;
      color: #9ca3af;
      transition: 0.18s ease;
    }

    .step-label {
      font-size: 11px;
      color: #9ca3af;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
      transition: 0.18s ease;
    }

    .step--active .step-circle {
      border-color: var(--primary);
      background: var(--primary-soft);
      color: var(--primary);
      font-weight: 600;
      transform: translateY(-1px);
    }

    .step--active .step-label {
      color: var(--primary);
      font-weight: 600;
    }

    .step--completed .step-circle {
      border-color: var(--primary);
      background: var(--primary);
      color: #fff;
    }

    .step--completed .step-label {
      color: var(--primary);
    }

    /* ───────── 6. MOBILE TAB SWITCH ───────── */

    .view-toggle {
      margin: 16px 0 12px;
      display: flex;
      justify-content: center;
    }

    .view-toggle-inner {
      display: inline-flex;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #fff;
      overflow: hidden;
    }

    .view-toggle-btn {
      padding: 7px 18px;
      font-size: 13px;
      border: none;
      background: transparent;
      cursor: pointer;
      color: var(--text-sub);
      transition: 0.15s ease;
    }

    .view-toggle-btn.is-active {
      background: var(--primary-soft);
      color: var(--primary);
      font-weight: 600;
    }

    @media (min-width: 900px) {
      .view-toggle {
        display: none;
      }
    }

/* ───────── 7. LAYOUT (preview + form) ───────── */

.layout {
  display: flex;
  gap: 18px;
  align-items: flex-start;
}

.preview-pane,
.form-pane {
  background: #fff;
  border-radius: 16px;
  padding: 16px 18px 18px;
  box-shadow: 0 12px 30px rgba(15, 23, 42, 0.10);
  flex: 1;
  min-width: 0;
}

/* ───────── 8. PREVIEW (JIS STYLE) ───────── */

/* 共通ユーティリティ */
.flex {
  display: flex;
}

/* A4プレビュー用カード（共通） */
.preview-card {
  font-weight: 400;
  border: 1px solid #e2e2e2;
  border-radius: 8px;
  background: #fff;
  color: #000;
  font-size: 15px;
  width: 100%;
  max-width: 794px;      /* A4 横幅相当 */
  /* min-height / aspect-ratio は使わない */
  margin: 0 auto;
  padding: 68px;
  box-sizing: border-box;
  word-wrap: break-word;
}

/* A4プレビューを包むコンテナ */
.preview-card-container {
  width: 100%;
  overflow: visible;
}

/* 履歴書プレビュー用（フォントサイズだけ調整） */
.preview-card.preview {
  font-weight: 400;
  background: #ffffff;
  color: #000;
  font-size: clamp(9px, 1.1vw, 11px);
}

/* 2ページ目以降との間隔（PC / モバイル共通） */
.preview-card.preview + .preview-card.preview {
  margin-top: 24px;   /* 好きな値に調整可。ピッタリにしたければ 16px とか */
}

.preview-title {
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 4px;
}

.preview-sub {
  margin-bottom: 8px;
}

/* ───────── PC（幅900px以上）───────── */

@media (min-width: 900px) {
  .layout {
    display: flex;
    gap: 18px;
    align-items: flex-start;
  }

  .layout.show-form .form-pane,
  .layout.show-preview .preview-pane {
    display: block;
  }

  /* 左右 1/2 ずつ固定 */
  .preview-pane,
  .form-pane {
    flex: 0 0 50%;
    max-width: 50%;
  }

  .preview-pane {
    padding: 12px 18px 12px;
  }
}

/* ───────── モバイル（幅899px以下）───────── */

@media (max-width: 899px) {
  /* レイアウト自体は縦並び */
  .layout {
    flex-direction: column;
  }

  .preview-pane,
  .form-pane {
    width: 100%;
    margin-bottom: 14px;
    box-shadow: 0 10px 25px rgba(15, 23, 42, 0.08);
  }

  /* 入力 / プレビュー切替 */
  .layout.show-form .preview-pane {
    display: none;
  }
  .layout.show-preview .form-pane {
    display: none;
  }

  /* モバイル用に少しコンパクトに */
  .preview-card.preview {
    width: 100%;
    max-width: 100%;
    padding: 24px;
    margin: 0 auto;
  }

  .preview-card-container {
    height: auto;
    overflow-y: visible;
    overflow-x: hidden;
  }

  .preview-pane {
    padding: 0 12px;
  }
}


/* ---- JIS履歴書の上部レイアウト（見本サイト準拠） ---- */
/* ─ 上部：氏名〜生年月日＋写真 ─ */

.rirekisho-top {
  display: flex;
}

/* 左側ブロック全体（タイトル〜氏名〜生年月日〜住所） */
.rirekisho-left {
  flex: 1 1 auto;
  min-width: 0;
}

/* 氏名〜生年月日を囲う枠線（タイトルは別） */
.rirekisho-box1 {
  border-left: 1px solid #111;
  border-right: 1px solid #111;
  border-top: none; 
  border-bottom: none;
  box-sizing: border-box;
}

/* 「履歴書」「○年○月○日現在」 */
.rirekisho-header {
  display: flex;
  align-items: flex-end;
  padding: 4px 8px 2px;
  border-bottom: 1px solid #111;
}

.rirekisho-header .title {
  font-size: clamp(14px, 3vw, 18px);
  letter-spacing: 0.4em;
  white-space: nowrap;
  margin-right: auto;
}

@media (max-width: 430px) {
  .rirekisho-header .title {
    font-size: 14px;
    letter-spacing: 0.3em;
  }
}

.preview-empty {
  color: #aaaaaa;
  text-align: center;
}

.rirekisho-header .date {
  font-size: 9px;
  white-space: nowrap;
}

/* 氏名ブロック全体 */
.rirekisho-profile {
  font-size: 10px;
}

/* 各行共通 */
.rirekisho-profile .ruby,
.rirekisho-profile .name {
  display: flex;
  align-items: center;
  border-bottom: 1px solid #111;
}

/* ふりがな */
.rirekisho-profile .ruby {
  padding: 2px 0;
  border-bottom: 1px dashed #111;
}

/* 名前 */
.rirekisho-profile .name {
  padding: 4px 0;
}

/* 左側ラベル */
.rirekisho-profile .label {
  width: 64px;
  padding-left: 4px;
  box-sizing: border-box;
}

/* 入力欄 */
.rirekisho-profile .input {
  flex: 1;
  padding: 2px 6px;
  box-sizing: border-box;
  text-align: center;
}

/* 名前だけフォント大きめ */
.rirekisho-profile .name .input {
  font-size: 14px;
}

/* ---- 生年月日＋性別の行 ---- */
.rirekisho-profile .etc {
  display: flex;
  justify-content: flex-end;
  padding: 2px;
}

.rirekisho-profile .birthday {
  flex: 1;
  text-align: right;
  padding-right: 6px;
}

.rirekisho-profile .gender {
  min-width: 70px;
  display: flex;
  gap: 4px;
  align-items: center;
}

.gender span.circle {
  border: 1px solid #000;
  border-radius: 50%;
  padding: 0 4px;
}


/* 写真エリア全体（外側の余白をかなり減らす） */
.rirekisho-photo {
  flex: 0 0 72px;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  margin-left: 6px;
  padding-top: 12px;
}

/* 写真枠（JIS の 4×3cm 比率に近づける） */
.jis-photo-cell {
  width: 69px;
  height: 92px;
  text-align: center;
  font-size: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
  padding: 2px;
}

.jis-photo-cell img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* ─ 住所／連絡先ブロック ─ */

.rirekisho-box2 {
  margin-top: 0;
  margin-bottom: 4px;
  border: 1px solid #111;
  box-sizing: border-box;
  font-size: 9px;
}

.contact-information {
  display: flex;
  border-bottom: 1px solid #111;
}

.contact-information:last-child {
  border-bottom: none;
}

.contact-information-address {
  flex: 2;
  border-right: 1px solid #111;
}

.contact-information-etc {
  flex: 1;
}

/* 各行共通（ふりがな／住所／電話／Email） */
.contact-information .ruby,
.contact-information .address,
.contact-information .tel,
.contact-information .email {
  display: flex;
  border-bottom: 1px solid #111;
  padding: 2px 0;
}

.contact-information .ruby {
  border-bottom: 1px dashed #111;
}

.contact-information .ruby:last-child,
.contact-information .address:last-child,
.contact-information .tel:last-child,
.contact-information .email:last-child {
  border-bottom: none;
}

.contact-information .label {
  width: 64px;
  padding-left: 4px;
  box-sizing: border-box;
}

.contact-information .input {
  width: 100%;
  padding: 2px 4px;
  box-sizing: border-box;
}

/* 改行付き住所 */
.contact-information .address pre {
  margin: 0;
  white-space: pre-wrap;
}

.contact-information-etc .tel .label,
.contact-information-etc .email .label {
  width: 32px;
}

/* Email 行だけ上下レイアウトにする */
.contact-information-etc .email {
  flex-direction: column;
  align-items: flex-start;  /* ラベルと中身を左寄せにしたい場合 */
}

.contact-information-etc .email .label {
  width: auto;   /* 32px固定を解除して自然な幅に */
}

.contact-information-etc .email .input {
  width: 100%;   /* 全幅使わせる */
}


#pv-address-kana-current {
  font-size: 6px;
}

#pv-contact-address {
  text-align: center;
}

/* 既存 JIS テーブル系（学歴・職歴、資格など）は今の .jis-table 系をそのまま利用 */

    /* 表全体の罫線をJISっぽく（黒・1px） */
    .jis-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 9px;
      margin-top: 0;
    }

    .jis-table th,
    .jis-table td {
      border: 1px solid #111;      /* 0.5px → 1px & 黒 */
      padding: 4px 6px;            /* ちょい広めに */
    }

    /* セクション見出しの線も太く */
    .jis-section-heading {
      font-size: 12px;
      font-weight: 600;
      border-bottom: 1px solid #111827;
      margin-bottom: 4px;
      padding-bottom: 2px;
    }

    /* タイトル行セル */
    .jis-title-cell {
      position: relative;
      height: 48px;              /* 好きに微調整してOK */
      text-align: center;
    }

    .jis-title {
      font-size: 20px;
      letter-spacing: 0.4em;
    }

    /* 日付を右上寄せに */
    .jis-date {
      position: absolute;
      right: 6px;
      bottom: 4px;
      font-size: 10px;
      white-space: nowrap;
    }
       
    .jis-col-label {
      width: 80px;
    }

    .jis-col-year {
      width: 40px;
      text-align: center;
    }

    .jis-col-month {
      width: 30px;
      text-align: center;
    }

    /* 学歴・職歴 / 免許・資格 の縦幅を統一する */
    .jis-table thead tr {
      height: 24px; 
    }

    .jis-table tbody tr {
      height: 24px;  
    }

    /* 行内のセルに余白（可読性アップ） */
    .jis-table td {
      padding: 6px 4px;
    }

    /* 学歴・職歴／免許・資格の tbody セルを全部センター寄せ */
    .jis-table tbody td {
      text-align: center;
      vertical-align: middle; /* 行の上下中央に揃えるならこれも推奨 */
    }

    /* 学歴・職歴ラベル行 */
    .jis-table tbody tr.edu-header-row td {
      font-weight: 600;
      text-align: center;
    }

    .jis-section {
      margin: 4px 0;
    }

    /* ボックス自体をラベル用に少し上を空ける */
    .jis-multiline-box {
      position: relative; 
      min-height: 70px;
      padding: 16px 6px 4px; 
      border: 0.5px solid #000000;
      background: #ffffff;
      font-size: 11px;
    }

    /* 中の span は普通に本文として下側に表示 */
    .jis-multiline-box span {
      display: block;
    }

    /* ▼ 志望動機のラベル（常時表示） */
    .jis-multiline-box.pr::before {
      content: "志望動機・特技・アピールポイントなど";
      position: absolute;
      top: 4px;          /* -18px → 4px（枠の内側に） */
      left: 6px;         /* 0 → 6px（枠の内側に合わせる） */
      font-size: 8px;
      color: #555;
      letter-spacing: 0.5px;
    }

    /* ▼ 本人希望欄のラベル（常時表示） */
    .jis-multiline-box.hope::before {
      content: "本人希望欄（給料・職種・勤務時間・勤務地・その他）";
      position: absolute;
      top: 4px;          /* 同じく枠の内側 */
      left: 6px;
      font-size: 8px;
      color: #555;
      letter-spacing: 0.5px;
    }

    /* ───────── 9. FORM STYLES ───────── */

    form {
      max-width: 900px;
      margin: 0 auto;
    }

    .field {
      margin-bottom: 16px;
    }

    .field label,
    .field-label {
      display: block;
      font-size: 12px;
      color: var(--text-sub);
      margin-bottom: 4px;
    }

      input[type='text'],
      input[type='email'],
      input[type='tel'],
      input[type='date'],
      textarea {
        width: 100%;
        padding: 8px;
        border-radius: 6px;
        border: 1px solid #ccc;
        box-sizing: border-box;
        font-size: 14px;
      }
      textarea {
        min-height: 80px;
        resize: vertical;
      }

    .field textarea {
      min-height: 90px;
    }

    .field input:focus,
    .field textarea:focus {
      border-color: var(--primary);
      background: #fff;
      box-shadow: 0 0 0 1px rgba(15,118,110,0.18);
    }

    .note {
      font-size: 12px;
      color: var(--text-sub);
    }

    .pr-checkbox-group {
      display: grid;
      grid-template-columns: 1fr;
      gap: 6px;
      margin-bottom: 12px;
    }

    .pr-checkbox-group label {
      display: flex;
      gap: 6px;
      padding: 6px 10px;
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      background: #f9fafb;
      cursor: pointer;
      transition: 0.15s ease;
    }

    .pr-checkbox-group label:hover {
      border-color: var(--primary);
      background: #ecfdf5;
    }

    .generate-pr-btn {
      margin-top: 4px;
      margin-bottom: 12px;
      padding: 8px 12px;
      background: var(--primary);
      color: #fff;
      border-radius: 6px;
      border: none;
      cursor: pointer;
    }

    .generate-pr-btn:hover {
      opacity: 0.85;
    }

    /* ステップ切り替え */
    .step-section {
      display: none;
      animation: fadeInStep 0.18s ease;
    }

    .step-section.is-active {
      display: block;
    }

    @keyframes fadeInStep {
      from { opacity: 0; transform: translateY(4px); }
      to { opacity: 1; transform: translateY(0); }
    }


    /* ───────── PDF 本番レイアウトのプレビュー ───────── */
    .pdf-preview-wrapper {
      margin-top: 18px;
      padding: 12px 16px 16px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
    }

    .pdf-preview-heading {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    /* PDFプレビュー枠はスクロールできるようにしておく（念のため） */
    .pdf-preview-frame {
      width: 100%;
      height: 260px;
      border-radius: 8px;
      overflow: auto;          /* ← overflow: hidden になっていたらこれに変更 */
      background: #f9fafb;
      border: 1px solid #d1d5db;
      margin-bottom: 8px;
    }

    /* 右側のプレビューだけ縮小表示する用 */
    #pdf-root.is-preview .pdf-a3-page {
      transform: scale(1.0);   /* まだ大きければ 0.5 くらいまで下げてもOK */
      transform-origin: top left;
    }

    /* 中で #pdf-root のクローンを縮小表示する用 */
    #pdf-preview-inner {
      width: 100%;
      height: 100%;
      overflow: auto;
    }

    #pdf-preview-inner .preview-card-container {
      /* クローン側の横幅をちょっと縮小して全体を見渡せるように */
      transform: scale(0.6);
      transform-origin: top left;
      width: 166.666%; /* 1/0.6 */
    }

    .pdf-preview-note {
      font-size: 12px;
      color: var(--text-sub);
      line-height: 1.5;
    }

    .pdf-preview-note span {
      font-weight: 600;
    }

    @media (min-width: 900px) {
      .pdf-preview-frame {
        height: 360px;             /* PCのときは少し大きく見せる */
      }
    }


    /* ───────── A3 横 1 枚の PDF レイアウト ───────── */

    /* ステップ6内のプレビュー全体 */
    .pdf-a3-layout {
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #f3f4f6;
    }

    /* 実際の A3 用紙（横長1枚分） */
    .pdf-a3-page {
      width: 100%;
      max-width: 1000px;         /* 画面上での表示サイズ */
      aspect-ratio: 420 / 297;   /* A3 横の比率 */
      background: #ffffff;
      border: 1px solid #d1d5db;
      box-shadow: 0 0 0 1px rgba(0,0,0,0.04);
      display: flex;             /* 左右に 1 ページずつ並べる */
      overflow: hidden;
    }

    /* 左右の「半分」 */
    .pdf-a3-left,
    .pdf-a3-right {
      flex: 1;
      overflow: hidden;
    }

    /* 中の preview-card を A3 用に調整 */
    .pdf-a3-left .preview-card,
    .pdf-a3-right .preview-card {
      width: 100%;
      max-width: none;
      margin: 0;
      padding: 32px 24px;
      border: none;
      box-shadow: none;
      box-sizing: border-box;
    }

    /* ───────── 10. NAVIGATION BUTTONS ───────── */

    .submit-row {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 18px;
    }

    .submit-button,
    .btn-prev,
    .btn-next,
    .btn-submit {
      padding: 9px 22px;
      border-radius: 999px;
      border: none;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
    }

    .btn-prev {
      background: #eee;
      color: #555;
    }

    .btn-next {
      background: var(--primary);
      color: #fff;
    }

    .btn-submit {
      background: var(--accent);
      color: #fff;
    }

    .btn-prev[disabled] {
      opacity: 0.5;
    }

    /* ───────── 11. SPECIAL FIELDS ───────── */

    .field-row-edu {
      display: flex;
      gap: 8px;
      margin-bottom: 10px;
    }

    .field--year { max-width: 90px; }
    .field--month { max-width: 70px; }
    .field--wide { flex: 1; }

    @media (max-width: 480px) {
      .field-row-edu {
        flex-wrap: wrap;
      }
      .field--year, .field--month {
        max-width: 80px;
      }
    }

    /* ───────── 12. RESPONSIVE TWEAKS ───────── */

    @media (max-width: 640px) {
      .page { padding: 22px 14px 28px; }
      .stepper-title { font-size: 14px; }
      .stepper::before { left: 30px; right: 30px; }
    }
    </style>

  </head>
  <body>
    <!-- 共通ヘッダー -->
    <header class="site-header">
      <a href="/">
        <div class="site-logo">ホイクレジュメ</div>
      </a>
    </header>
    
    <!-- ステップバー -->
    <div class="stepper-container">
      <div class="stepper-title">保育士 履歴書</div>
      <div class="stepper" id="career-stepper">
        <div class="step step--active" data-step="1">
          <div class="step-circle">1</div>
          <div class="step-label">基本情報</div>
        </div>
        <div class="step" data-step="2">
          <div class="step-circle">2</div>
          <div class="step-label">職歴</div>
        </div>
        <div class="step" data-step="3">
          <div class="step-circle">3</div>
          <div class="step-label">資格</div>
        </div>
        <div class="step" data-step="4">
          <div class="step-circle">4</div>
          <div class="step-label">志望動機</div>
        </div>
        <div class="step" data-step="5">
          <div class="step-circle">5</div>
          <div class="step-label">希望欄</div>
        </div>
        <div class="step" data-step="6">
          <div class="step-circle">6</div>
          <div class="step-label">確認</div>
        </div>
      </div>
    </div>

    <main class="page">
      <h1 class="page-title">履歴書を作成する</h1>

      <!-- モバイル：入力 / プレビュー切り替え -->
      <div class="view-toggle">
        <div class="view-toggle-inner">
          <button
            type="button"
            class="view-toggle-btn is-active"
            data-view="form"
          >
            入力画面
          </button>
          <button
            type="button"
            class="view-toggle-btn"
            data-view="preview"
          >
            プレビュー画面
          </button>
        </div>
      </div>

      <!-- メインレイアウト -->
      <div class="layout show-form" id="career-layout">
        <!-- 左：プレビュー -->
        <div class="preview-pane">
          <div class="preview-title">履歴書プレビュー</div>
          <div class="preview-sub">
            このプレビューとほぼ同じレイアウトでPDFが作成されます。
          </div>

          <!-- ここから JIS レイアウト（2ページ構成） -->
          <div class="preview-card-container" id="preview-root">

            <!-- ===== 1ページ目：プロフィール + 学歴・職歴（15行） ===== -->
            <div class="preview-card preview page-1">
              <!-- 上部：タイトル / 氏名 / 生年月日・性別 ＋ 写真 -->
              <div class="rirekisho-top">
                <!-- 左側：タイトル＋氏名ブロック -->
                <div class="rirekisho-left">
                  <!-- タイトル行 -->
                  <div class="rirekisho-header">
                    <div class="title">履　歴　書</div>
                    <div class="date"><span id="pv-date"></span></div>
                  </div>

                  <!-- 氏名～生年月日・性別の枠 -->
                  <div class="rirekisho-box1">
                    <div class="rirekisho-profile">
                      <div class="ruby flex">
                        <div class="label">ふりがな</div>
                        <div id="pv-furigana" class="input preview-empty">未入力</div>
                      </div>
                      <div class="name flex">
                        <div class="label">氏　名</div>
                        <div id="pv-name" class="input preview-empty">未入力</div>
                      </div>
                      <div class="etc flex">
                        <div id="pv-birth" class="birthday preview-empty">未入力</div>
                        <div id="pv-gender" class="gender preview-empty">
                          <span class="male">男</span><span>・</span><span class="female">女</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- 右側：写真 -->
                <div class="rirekisho-photo">
                  <div class="jis-photo-cell">
                    写真（4×3cm）
                  </div>
                </div>
              </div>

              <!-- 現住所・連絡先 -->
              <div class="rirekisho-box2">
                <!-- 現住所＋電話・メール -->
                <div class="contact-information contact-main">
                  <div class="contact-information-address">
                    <div class="ruby">
                      <div class="label">ふりがな</div>
                      <div id="pv-address-kana-current" class="input preview-empty">未入力</div>
                    </div>
                    <div class="address">
                      <div class="label">現住所　〒</div>
                      <div class="input">
                        <div id="pv-address" class="preview-empty">未入力</div>
                      </div>
                    </div>
                  </div>
                  <div class="contact-information-etc">
                    <div class="tel">
                      <div class="label">電話</div>
                      <div id="pv-phone" class="input preview-empty"></div>
                    </div>
                    <div class="email">
                      <div class="label">Email</div>
                      <div id="pv-email" class="input preview-empty"></div>
                    </div>
                  </div>
                </div>

                <!-- 連絡先（別住所） -->
                <div class="contact-information contact-sub">
                  <div class="contact-information-address">
                    <div class="ruby">
                      <div class="label">ふりがな</div>
                      <div id="pv-address-kana-contact" class="input preview-empty"></div>
                    </div>
                    <div class="address">
                      <div class="label">連絡先　〒</div>
                      <div class="input">
                        <div id="pv-contact-address" class="preview-empty">
                          （現住所以外に連絡を希望する場合のみ記入）
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="contact-information-etc">
                    <div class="tel">
                      <div class="label">電話</div>
                      <div id="pv-phone-contact" class="input preview-empty"></div>
                    </div>
                    <div class="email">
                      <div class="label">Email</div>
                      <div id="pv-email-contact" class="input preview-empty"></div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- 学歴・職歴（1〜15行目） -->
              <div class="jis-section">
                <table class="jis-table">
                  <thead>
                    <tr>
                      <th class="jis-col-year">年</th>
                      <th class="jis-col-month">月</th>
                      <th class="jis-col-text">学歴・職歴</th>
                    </tr>
                  </thead>
                  <tbody id="edu-preview-body-page1"></tbody>
                </table>
              </div>
            </div>

            <!-- ===== 2ページ目：学歴・職歴（続き7行）+ 資格6行 + 志望動機 + 本人希望欄 ===== -->
            <div class="preview-card preview page-2">

              <!-- 学歴・職歴（続き 16〜22行目） -->
              <div class="jis-section">
                <table class="jis-table">
                  <thead>
                    <tr>
                      <th class="jis-col-year">年</th>
                      <th class="jis-col-month">月</th>
                      <th class="jis-col-text">学歴・職歴</th>
                    </tr>
                  </thead>
                  <tbody id="edu-preview-body-page2"></tbody>
                </table>
              </div>

              <!-- 免許・資格（6行） -->
              <div class="jis-section">
                <table class="jis-table">
                  <thead>
                    <tr>
                      <th class="jis-col-year">年</th>
                      <th class="jis-col-month">月</th>
                      <th class="jis-col-text">免許・資格</th>
                    </tr>
                  </thead>
                  <tbody id="lic-preview-body"></tbody>
                </table>
              </div>

              <!-- 志望動機 -->
              <div class="jis-section">
                <div class="jis-multiline-box pr">
                  <span id="pv-prText" class="preview-empty">
                    （ここに志望動機が自動入力されます）
                  </span>
                </div>
              </div>

              <!-- 本人希望欄 -->
              <div class="jis-section">
                <div class="jis-multiline-box hope">
                  <span id="pv-hopeText" class="preview-empty">
                    （ここに本人希望欄の内容が入ります）
                  </span>
                </div>
              </div>
            </div>

          </div>
          <!-- ここまで JIS レイアウト -->

        </div>

        <!-- 右：入力フォーム -->
        <div class="form-pane">
          <form id="resume-form" method="post" action="/career/preview">

            <!-- STEP 1: 基本情報 -->
            <div class="step-section is-active" data-step="1">
              <h3>基本情報を入力</h3>

              <!-- ふりがな（姓・名） -->
              <div class="field">
                <label>ふりがな</label>
                <div style="display:flex; gap:8px;">
                  <input
                    type="text"
                    id="furiganaLast"
                    name="furiganaLast"
                    placeholder="せい"
                    style="flex:1;"
                  />
                  <input
                    type="text"
                    id="furiganaFirst"
                    name="furiganaFirst"
                    placeholder="めい"
                    style="flex:1;"
                  />
                </div>
                <!-- サーバー送信用（結合済み） -->
                <input type="hidden" id="furigana" name="furigana" />
              </div>

              <!-- 氏名（漢字：姓・名） -->
              <div class="field">
                <label>氏名（漢字）</label>
                <div style="display:flex; gap:8px;">
                  <input
                    type="text"
                    id="nameLast"
                    name="nameLast"
                    placeholder="姓"
                    style="flex:1;"
                    required
                  />
                  <input
                    type="text"
                    id="nameFirst"
                    name="nameFirst"
                    placeholder="名"
                    style="flex:1;"
                    required
                  />
                </div>
                <!-- サーバー送信用（結合済み） -->
                <input type="hidden" id="name" name="name" />
              </div>

              <div class="field">
                <label for="birth">生年月日</label>
                <input type="date" id="birth" name="birth" />
              </div>

              <div class="field">
                <label>性別</label>
                <label style="margin-right:8px;">
                  <input type="radio" name="gender" value="男" checked />
                  男
                </label>
                <label>
                  <input type="radio" name="gender" value="女" />
                  女
                </label>
              </div>

            <!-- 現住所 -->
            <div class="field">
              <label>現住所</label>

              <!-- ふりがな -->
              <input
                type="text"
                id="addressKanaCurrent"
                placeholder="ふりがな（例：とうきょうとしんじゅくく〜）"
                style="margin-bottom:6px;"
              />

              <!-- 郵便番号 -->
              <input
                type="text"
                id="addressZipCurrent"
                placeholder="郵便番号（例：123-4567）"
                style="margin-bottom:6px;"
              />

              <!-- 都道府県〜住所 -->
              <input
                type="text"
                id="addressPrefCurrent"
                placeholder="都道府県（例：東京都）"
                style="margin-bottom:6px;"
              />
              <input
                type="text"
                id="addressCityCurrent"
                placeholder="市区町村（例：新宿区）"
                style="margin-bottom:6px;"
              />
              <input
                type="text"
                id="address1Current"
                placeholder="住所1（番地）"
                style="margin-bottom:6px;"
              />
              <input
                type="text"
                id="address2Current"
                placeholder="住所2（建物名・部屋番号など）"
              />

              <!-- サーバー送信用（結合済み） -->
              <input type="hidden" id="address-current-hidden" name="addressCurrent" />
            </div>

            <div class="field">
              <label for="phone">電話</label>
              <input type="tel" id="phone" name="phone" />
            </div>

            <div class="field">
              <label for="email">Email</label>
              <input type="email" id="email" name="email" />
            </div>

            <!-- 連絡先 -->
            <div class="field">
              <div
                style="display:flex;justify-content:space-between;align-items:center;gap:8px;"
              >
                <label style="margin-bottom:0;">連絡先（現住所と異なる場合のみ）</label>
                <label
                  style="font-size:12px;display:flex;align-items:center;gap:4px;cursor:pointer;"
                >
                  <input type="checkbox" id="contactSameAsCurrent" />
                  現住所と同一
                </label>
              </div>

              <!-- ふりがな -->
              <input
                type="text"
                id="addressKanaContact"
                placeholder="ふりがな（例：とうきょうとしんじゅくく〜）"
                style="margin:6px 0;"
              />

              <!-- 郵便番号 -->
              <input
                type="text"
                id="addressZipContact"
                placeholder="郵便番号（例：123-4567）"
                style="margin-bottom:6px;"
              />

              <!-- 都道府県〜住所 -->
              <input
                type="text"
                id="addressPrefContact"
                placeholder="都道府県（例：東京都）"
                style="margin-bottom:6px;"
              />
              <input
                type="text"
                id="addressCityContact"
                placeholder="市区町村（例：新宿区）"
                style="margin-bottom:6px;"
              />
              <input
                type="text"
                id="address1Contact"
                placeholder="住所1（番地）"
                style="margin-bottom:6px;"
              />
              <input
                type="text"
                id="address2Contact"
                placeholder="住所2（建物名・部屋番号など）"
              />

              <!-- サーバー送信用（結合済み） -->
              <input type="hidden" id="address-contact-hidden" name="addressContact" />
            </div>

            <div class="field">
              <label for="phoneContact">電話</label>
              <input type="tel" id="phoneContact" name="phoneContact" />
            </div>

            <div class="field">
              <label for="emailContact">Email</label>
              <input type="email" id="emailContact" name="emailContact" />
            </div>


              <div class="field">
                <label for="photo">写真（4×3cm 推奨）</label>
                <input type="file" id="photo" accept="image/*" />
              </div>
            </div>

            <!-- STEP 2: 学歴・職歴 -->
            <div class="step-section" data-step="2">
              <h3>学歴・職歴を入力</h3>
              <p class="note">
                学歴と職歴をそれぞれ入力してください。<br />
                1行につき1つずつ入力します。<br />
                例）「2018年 3月 市立△△中学校卒業」「2022年 4月 △△保育園入社」など。
              </p>

              <!-- ▼ 学歴エリア -->
              <p class="field-label">学歴</p>
              <div id="edu-container-school"></div>
              <button type="button" id="add-edu-school-btn" class="generate-pr-btn">
                ＋ 学歴の行を追加
              </button>

              <!-- ▼ 職歴エリア -->
              <p class="field-label" style="margin-top:16px;">職歴</p>
              <div id="edu-container-work"></div>
              <button type="button" id="add-edu-work-btn" class="generate-pr-btn">
                ＋ 職歴の行を追加
              </button>

              <!-- 入力行のテンプレート（共通） -->
              <template id="edu-template">
                <div class="field-row-edu edu-row">
                  <div class="field field--year">
                    <label>年</label>
                    <input
                      type="text"
                      class="edu-year"
                      name="edu_year[]"
                      placeholder="2018"
                    />
                  </div>

                  <div class="field field--month">
                    <label>月</label>
                    <input
                      type="text"
                      class="edu-month"
                      name="edu_month[]"
                      placeholder="3"
                    />
                  </div>

                  <div class="field field--wide">
                    <label>内容</label>
                    <input
                      type="text"
                      class="edu-text"
                      name="edu_text[]"
                      placeholder="市立△△中学校卒業 / △△保育園入社 など"
                    />
                  </div>
                </div>
              </template>
            </div>

            <!-- STEP 3: 免許・資格 -->
            <div class="step-section" data-step="3">
              <h3>免許・資格を入力</h3>
              <p class="note">
                1行につき1つずつ入力してください。<br />
                例）「2013年 4月 実用英語技能検定3級合格」<br />
                行数に制限はありません。
              </p>

              <!-- 行が入っていくコンテナ -->
              <div id="lic-container"></div>

              <!-- 行を追加ボタン -->
              <button type="button" id="add-lic-btn" class="generate-pr-btn">
                ＋ 行を追加
              </button>

              <!-- 入力行テンプレート -->
              <template id="lic-template">
                <div class="field-row-edu lic-row">
                  <div class="field field--year">
                    <label>年</label>
                    <input
                      type="text"
                      class="lic-year"
                      name="lic_year[]"
                      placeholder="2013"
                    />
                  </div>

                  <div class="field field--month">
                    <label>月</label>
                    <input
                      type="text"
                      class="lic-month"
                      name="lic_month[]"
                      placeholder="4"
                    />
                  </div>

                  <div class="field field--wide">
                    <label>資格・検定など</label>
                    <input
                      type="text"
                      class="lic-text"
                      name="lic_text[]"
                      placeholder="実用英語技能検定3級合格"
                    />
                  </div>
                </div>
              </template>
            </div>

            <!-- STEP 4: 志望動機（自動生成） -->
            <div class="step-section" data-step="4">
              <h3>志望動機を選択して自動生成</h3>

              <p class="field-label">
                当てはまる項目を選んでください（複数可）
              </p>
              <div class="pr-checkbox-group">
                <label><input type="checkbox" class="pr-option" value="子ども一人ひとりに寄り添う保育を大切にしてきました。"> 子ども一人ひとりへの寄り添い</label>
                <label><input type="checkbox" class="pr-option" value="保護者との丁寧な連携を心がけてきました。"> 保護者との連携</label>
                <label><input type="checkbox" class="pr-option" value="行事運営や制作活動に積極的に取り組んできました。"> 行事運営・制作活動</label>
                <label><input type="checkbox" class="pr-option" value="0〜2歳児クラスの担任経験が豊富です。"> 0〜2歳児の経験</label>
                <label><input type="checkbox" class="pr-option" value="幅広い年齢のクラスを経験してきました。"> 幅広い年齢のクラス経験</label>
                <label><input type="checkbox" class="pr-option" value="チームで協力しながら業務を進めることが得意です。"> チームワーク</label>
                <label><input type="checkbox" class="pr-option" value="急なシフト変更やトラブルにも柔軟に対応してきました。"> 柔軟な対応力</label>
                <label><input type="checkbox" class="pr-option" value="明るく穏やかな雰囲気づくりを大切にしています。"> 明るく穏やかな人柄</label>
                <label><input type="checkbox" class="pr-option" value="健康管理や安全面に特に配慮してきました。"> 安全面・健康面への配慮</label>
                <label><input type="checkbox" class="pr-option" value="新しい保育の知識や研修にも積極的に参加しています。"> 学び続ける姿勢</label>
              </div>

              <button id="generatePR" class="generate-pr-btn" type="button">
                選択内容から志望動機を自動生成する
              </button>

              <p class="field-label">志望動機（編集もOK）</p>
              <textarea
                id="prText"
                name="pr"
                rows="6"
                placeholder="自動生成ボタンを押すと、ここに志望動機が入ります。"
              ></textarea>
            </div>

            <!-- STEP 5: 本人希望欄 -->
            <div class="step-section" data-step="5">
              <h3>本人希望欄</h3>

              <p class="field-label">
                希望条件（当てはまるものを選択・複数可）
              </p>
              <div class="pr-checkbox-group">
                <label><input type="checkbox" class="hope-option" value="給与は園規定に準じます。"> 給与は園規定に準じます。</label>
                <label><input type="checkbox" class="hope-option" value="正社員として長期的に勤務したいと考えております。"> 正社員として長期的に勤務したいと考えております。</label>
                <label><input type="checkbox" class="hope-option" value="勤務時間はフルタイムを希望しております。"> 勤務時間はフルタイムを希望しております。</label>
                <label><input type="checkbox" class="hope-option" value="早番・遅番を含むシフト勤務にも対応可能です。"> 早番・遅番を含むシフト勤務にも対応可能です。</label>
                <label><input type="checkbox" class="hope-option" value="通勤時間はおおむね1時間以内を希望しております。"> 通勤時間はおおむね1時間以内を希望しております。</label>
                <label><input type="checkbox" class="hope-option" value="勤務地は貴園所在エリア周辺を希望しております。"> 勤務地は貴園所在エリア周辺を希望しております。</label>
                <label><input type="checkbox" class="hope-option" value="家庭の事情により土日祝日は勤務を控えたいと考えております。"> 土日祝日は勤務を控えたいと考えております。</label>
                <label><input type="checkbox" class="hope-option" value="扶養内勤務を希望しております。"> 扶養内勤務を希望しております。</label>
              </div>

              <button id="generateHope" class="generate-pr-btn" type="button">
                選択内容から本文を自動入力する
              </button>

              <p class="field-label">本人希望欄（編集もOK）</p>
              <textarea
                id="hopeText"
                name="hope"
                rows="5"
                placeholder="自動入力ボタンを押すと、ここに本人希望欄の文章が入ります。"
              ></textarea>
            </div>

            <!-- STEP 6: 確認・PDF -->
            <div class="step-section" data-step="6">
              <h3>内容確認・PDFダウンロード</h3>
              <p class="note">
                左側のプレビューを確認し、誤字脱字や日付などに問題がないかチェックしてください。<br />
                問題なければ下の「PDFをダウンロード」ボタンを押してください。
              </p>
            </div>

            <!-- ナビゲーションボタン -->
            <div class="submit-row">
              <button
                type="button"
                class="btn-prev"
                id="resume-prev"
              >＜ 前へ</button>

              <button
                type="button"
                class="btn-next"
                id="resume-next"
              >次へ ＞</button>

              <button
                type="submit"
                class="btn-submit"
                id="btn-submit-resume"
                style="display:none;"
              >
                PDFをダウンロード
              </button>
            </div>

          </form>
        </div>
      </div>
    </main>

    <script>
      // ─────────────────────────
      // モバイル：入力 / プレビュー 切り替え
      // ─────────────────────────
      (function () {
        const layout = document.getElementById('career-layout');
        const buttons = document.querySelectorAll('.view-toggle-btn');
        if (!layout || !buttons.length) return;

        buttons.forEach((btn) => {
          btn.addEventListener('click', () => {
            const view = btn.dataset.view;
            buttons.forEach((b) => b.classList.remove('is-active'));
            btn.classList.add('is-active');

            if (view === 'form') {
              layout.classList.add('show-form');
              layout.classList.remove('show-preview');
            } else {
              layout.classList.add('show-preview');
              layout.classList.remove('show-form');
            }
          });
        });
      })();


      // ───────── A3 横1枚レイアウトを PDF用に一時生成する ─────────
function createA3LayoutForPdf() {
  // プレビューの1ページ目・2ページ目を取得
  const page1 = document.querySelector('#preview-root .preview-card.preview.page-1');
  const page2 = document.querySelector('#preview-root .preview-card.preview.page-2');

  if (!page1 || !page2) return null;

  // 画面外に置く一時コンテナ
  const container = document.createElement('div');
  container.id = 'pdf-temp-root';
  container.style.position = 'fixed';
  container.style.left = '-9999px'; // 画面外
  container.style.top = '0';
  container.style.width = '1400px'; // 描画用の幅（適当でOK）
  container.style.background = '#ffffff';
  container.style.zIndex = '-1';

  // A3ページ本体（CSSの .pdf-a3-page をそのまま使う）
  const wrapper = document.createElement('div');
  wrapper.className = 'pdf-a3-page';

  const left = document.createElement('div');
  left.className = 'pdf-a3-left';
  left.appendChild(page1.cloneNode(true));  // プレビュー1ページ目のクローン

  const right = document.createElement('div');
  right.className = 'pdf-a3-right';
  right.appendChild(page2.cloneNode(true)); // プレビュー2ページ目のクローン

  wrapper.appendChild(left);
  wrapper.appendChild(right);
  container.appendChild(wrapper);

  // bodyに一時的に追加
  document.body.appendChild(container);

  return container;
}

      // ─────────────────────────
      // ステップ制ロジック（6ステップ）
      // ─────────────────────────
      (function () {
        const totalSteps = 6;
        let currentStep = 1;

        const stepSections = document.querySelectorAll('.step-section');
        const stepElems = document.querySelectorAll('#career-stepper .step');
        const prevBtn = document.getElementById('resume-prev');
        const nextBtn = document.getElementById('resume-next');
        const submitBtn = document.getElementById('btn-submit-resume');

        if (!stepSections.length) return;

        function showStep(step) {
          currentStep = step;

          // section の表示切り替え
          stepSections.forEach((sec) => {
            const s = parseInt(sec.dataset.step, 10);
            sec.classList.toggle('is-active', s === currentStep);
          });

          // ステッパーの見た目更新
          stepElems.forEach((el) => {
            const s = parseInt(el.dataset.step, 10);
            el.classList.remove('step--active', 'step--completed');
            if (s < currentStep) {
              el.classList.add('step--completed');
            } else if (s === currentStep) {
              el.classList.add('step--active');
            }
          });

          // 前へボタン
          if (prevBtn) prevBtn.disabled = currentStep === 1;

          // 次へ / PDF ボタン
          if (nextBtn && submitBtn) {
            if (currentStep === totalSteps) {
              nextBtn.style.display = 'none';
              submitBtn.style.display = 'inline-flex';
            } else {
              nextBtn.style.display = 'inline-flex';
              submitBtn.style.display = 'none';
            }
          }
        }

        if (prevBtn) {
          prevBtn.addEventListener('click', () => {
            if (currentStep > 1) showStep(currentStep - 1);
          });
        }

        if (nextBtn) {
          nextBtn.addEventListener('click', () => {
            if (currentStep < totalSteps) showStep(currentStep + 1);
          });
        }

        // ステップバークリックでジャンプ
        stepElems.forEach((el) => {
          el.addEventListener('click', () => {
            const targetStep = parseInt(el.dataset.step, 10);
            if (!Number.isNaN(targetStep)) showStep(targetStep);
          });
        });

        showStep(1);
      })();

      // ─────────────────────────
      // プレビュー共通ユーティリティ
      // ─────────────────────────
      function bindText(inputId, previewId, options) {
        const input = document.getElementById(inputId);
        const preview = document.getElementById(previewId);
        if (!input || !preview) return;

        const defaultText =
          (preview.dataset && preview.dataset.default) || preview.textContent || '未入力';
        if (preview.dataset) preview.dataset.default = defaultText;

        const update = () => {
          const v = input.value.trim();
          if (v) {
            preview.textContent = v;
            preview.classList.remove('preview-empty');
          } else {
            preview.textContent = defaultText;
            preview.classList.add('preview-empty');
          }
        };

        input.addEventListener('input', update);
        update();
      }

      // ─────────────────────────
      // 基本情報 → プレビュー
      // ─────────────────────────
      (function () {
        bindText('phone', 'pv-phone');
        bindText('email', 'pv-email');

        // ▼ ここから追加：姓・名を分けて入力 → スペース結合でプレビュー更新
        (function () {
          const furiganaLast  = document.getElementById('furiganaLast');
          const furiganaFirst = document.getElementById('furiganaFirst');
          const nameLast      = document.getElementById('nameLast');
          const nameFirst     = document.getElementById('nameFirst');

          const pvFurigana = document.getElementById('pv-furigana');
          const pvName     = document.getElementById('pv-name');

          const hiddenFurigana = document.getElementById('furigana'); // hidden
          const hiddenName     = document.getElementById('name');     // hidden

          if (!pvFurigana || !pvName) return;

          const defaultFurigana = '未入力';
          const defaultName     = '未入力';

          function updateNamePreview() {
            const fLast  = (furiganaLast?.value  || '').trim();
            const fFirst = (furiganaFirst?.value || '').trim();
            const nLast  = (nameLast?.value      || '').trim();
            const nFirst = (nameFirst?.value     || '').trim();

            const fullFurigana = [fLast, fFirst].filter(Boolean).join(' ');
            const fullName     = [nLast, nFirst].filter(Boolean).join(' ');

            // プレビュー更新（ふりがな）
            if (fullFurigana) {
              pvFurigana.textContent = fullFurigana;
              pvFurigana.classList.remove('preview-empty');
            } else {
              pvFurigana.textContent = defaultFurigana;
              pvFurigana.classList.add('preview-empty');
            }

            // プレビュー更新（漢字氏名）
            if (fullName) {
              pvName.textContent = fullName;
              pvName.classList.remove('preview-empty');
            } else {
              pvName.textContent = defaultName;
              pvName.classList.add('preview-empty');
            }

            // hidden にも結合した値を入れておく（サーバー送信用）
            if (hiddenFurigana) hiddenFurigana.value = fullFurigana;
            if (hiddenName)     hiddenName.value     = fullName;
          }

          // 4つの入力欄にイベントを貼る
          [furiganaLast, furiganaFirst, nameLast, nameFirst].forEach((el) => {
            if (!el) return;
            el.addEventListener('input', updateNamePreview);
          });

          // 初期表示
          updateNamePreview();
        })();


      // ───────── 生年月日 ＋ 性別（プレビュー）─────────
      const birthInput = document.getElementById('birth');
      const genderRadios = document.querySelectorAll('input[name="gender"]');
      const pvBirth = document.getElementById('pv-birth');
      const pvGender = document.getElementById('pv-gender');

      // 満年齢を計算する関数
      function calcAge(dateStr) {
        const birth = new Date(dateStr);
        if (isNaN(birth.getTime())) return null;

        const today = new Date();
        let age = today.getFullYear() - birth.getFullYear();

        const m = today.getMonth() - birth.getMonth();
        if (m < 0 || (m === 0 && today.getDate() < birth.getDate())) {
          age--;
        }
        return age;
      }

      // 生年月日 + （満○歳）のプレビュー
      function updateBirthPreview() {
        if (!pvBirth) return;

        if (birthInput && birthInput.value) {
          const d = new Date(birthInput.value);
          let ageText = '（満○歳）';

          if (!isNaN(d.getTime())) {
            const y = d.getFullYear();
            const m = d.getMonth() + 1;
            const day = d.getDate();

            const age = calcAge(birthInput.value);
            if (age !== null) {
              ageText = `（満${age}歳）`;
            }

            pvBirth.textContent = `${y}年${m}月${day}日生${ageText}`;
            pvBirth.classList.remove('preview-empty');
          } else {
            // 変な値が入ったときはそのまま + 満○歳
            pvBirth.textContent = `${birthInput.value}（満○歳）`;
            pvBirth.classList.remove('preview-empty');
          }
        } else {
          pvBirth.textContent = '未入力（満○歳）';
          pvBirth.classList.add('preview-empty');
        }
      }

      // 性別プレビュー（「男・女」を常に表示して、選択だけ丸で囲む）
      function updateGenderPreview() {
        if (!pvGender || genderRadios.length < 2) return;

        // ベース表示を毎回リセット
        pvGender.innerHTML =
          '<span class="male">男</span><span>・</span><span class="female">女</span>';

        const maleSpan = pvGender.querySelector('.male');
        const femaleSpan = pvGender.querySelector('.female');

        // ラジオ 1個目＝男, 2個目＝女 として扱う
        const maleChecked = genderRadios[0].checked;
        const femaleChecked = genderRadios[1].checked;

        if (maleChecked) {
          maleSpan.classList.add('circle');
        }
        if (femaleChecked) {
          femaleSpan.classList.add('circle');
        }

        if (!maleChecked && !femaleChecked) {
          pvGender.classList.add('preview-empty');
        } else {
          pvGender.classList.remove('preview-empty');
        }
      }

      // 両方まとめて更新
      function updateBirthGenderPreview() {
        updateBirthPreview();
        updateGenderPreview();
      }

      if (birthInput) {
        birthInput.addEventListener('input', updateBirthGenderPreview);
      }
      genderRadios.forEach((r) => {
        r.addEventListener('change', updateBirthGenderPreview);
      });

      // 初期表示
      updateBirthGenderPreview();


      /* ============================
        郵便番号フォーマット
        ============================ */
      function formatZip(value) {
        const digits = value.replace(/\D/g, '').slice(0, 7); // 数字7桁まで
        if (digits.length <= 3) return digits;
        return digits.slice(0, 3) + '-' + digits.slice(3);
      }

      /* ============================
        フル住所を結合するヘルパー
        ============================ */
      function buildAddress(zip, pref, city, addr1, addr2) {
        let result = '';

        if (zip) result += `〒${zip} `;
        if (pref) result += pref;
        if (city) result += city;
        if (addr1) result += addr1;
        if (addr2) result += ' ' + addr2;

        return result.trim();
      }

      /* ============================
        現住所 → プレビュー
        ============================ */
      function updateCurrentAddressPreview() {
        const zip = document.getElementById('addressZipCurrent').value;
        const pref = document.getElementById('addressPrefCurrent').value;
        const city = document.getElementById('addressCityCurrent').value;
        const addr1 = document.getElementById('address1Current').value;
        const addr2 = document.getElementById('address2Current').value;
        const kana = document.getElementById('addressKanaCurrent').value;

        const full = buildAddress(zip, pref, city, addr1, addr2);

        // hidden（サーバー用）
        const hidden = document.getElementById('address-current-hidden');
        if (hidden) hidden.value = full;

        // 住所プレビュー
        const pvAddr = document.getElementById('pv-address');
        if (pvAddr) {
          if (full) {
            pvAddr.textContent = full;
            pvAddr.classList.remove('preview-empty');
          } else {
            pvAddr.textContent = '未入力';
            pvAddr.classList.add('preview-empty');
          }
        }

        // 住所ふりがなプレビュー
        const pvKana = document.getElementById('pv-address-kana-current');
        if (pvKana) {
          if (kana) {
            pvKana.textContent = kana;
            pvKana.classList.remove('preview-empty');
          } else {
            pvKana.textContent = '';
            pvKana.classList.add('preview-empty');
          }
        }
      }

      /* ============================
        連絡先 → hidden & プレビュー
        ============================ */
      function updateContactAddress() {
        const same = document.getElementById('contactSameAsCurrent').checked;
        const pvContactAddr = document.getElementById('pv-contact-address');
        const pvContactKana = document.getElementById('pv-address-kana-contact');

        // 「現住所と同一」のときは JS 側では「同上」固定
        if (same) {
          if (pvContactAddr) {
            pvContactAddr.textContent = '同上';
            pvContactAddr.classList.remove('preview-empty');
          }
          if (pvContactKana) {
            pvContactKana.textContent = '';
            pvContactKana.classList.add('preview-empty');
          }
          const hidden = document.getElementById('address-contact-hidden');
          if (hidden) hidden.value = document.getElementById('address-current-hidden').value || '';
          return;
        }

        // 同一じゃないときは普通に連絡先住所を組み立て
        const zip = document.getElementById('addressZipContact').value;
        const pref = document.getElementById('addressPrefContact').value;
        const city = document.getElementById('addressCityContact').value;
        const addr1 = document.getElementById('address1Contact').value;
        const addr2 = document.getElementById('address2Contact').value;
        const kana = document.getElementById('addressKanaContact').value;

        const full = buildAddress(zip, pref, city, addr1, addr2);

        // hidden
        const hidden = document.getElementById('address-contact-hidden');
        if (hidden) hidden.value = full;

        // 住所プレビュー
        if (pvContactAddr) {
          if (full) {
            pvContactAddr.textContent = full;
            pvContactAddr.classList.remove('preview-empty');
          } else {
            pvContactAddr.textContent = '〒（現住所以外に連絡を希望する場合のみ入力）';
            pvContactAddr.classList.add('preview-empty');
          }
        }

        // ふりがなプレビュー
        if (pvContactKana) {
          if (kana) {
            pvContactKana.textContent = kana;
            pvContactKana.classList.remove('preview-empty');
          } else {
            pvContactKana.textContent = '';
            pvContactKana.classList.add('preview-empty');
          }
        }
      }

      /* ============================
        「現住所と同一」チェック
        ============================ */
      function initAddressSync() {
        const check = document.getElementById('contactSameAsCurrent');
        if (!check) return;

        check.addEventListener('change', () => {
          const ids = [
            'addressKanaContact',
            'addressZipContact',
            'addressPrefContact',
            'addressCityContact',
            'address1Contact',
            'address2Contact',
          ];

          if (check.checked) {
            // 現住所からコピー
            document.getElementById('addressKanaContact').value =
              document.getElementById('addressKanaCurrent').value;
            document.getElementById('addressZipContact').value =
              document.getElementById('addressZipCurrent').value;
            document.getElementById('addressPrefContact').value =
              document.getElementById('addressPrefCurrent').value;
            document.getElementById('addressCityContact').value =
              document.getElementById('addressCityCurrent').value;
            document.getElementById('address1Contact').value =
              document.getElementById('address1Current').value;
            document.getElementById('address2Contact').value =
              document.getElementById('address2Current').value;

            // 入力ロック
            ids.forEach((id) => {
              document.getElementById(id).readOnly = true;
            });
          } else {
            // ロック解除（値はそのままにしておく）
            ids.forEach((id) => {
              document.getElementById(id).readOnly = false;
            });
          }

          // プレビュー更新
          updateContactAddress();
        });
      }

      /* ============================
        電話・メール → プレビュー
        ============================ */
      function updatePhonePreview() {
        const val = document.getElementById('phone').value;
        const pv = document.getElementById('pv-phone');
        if (!pv) return;

        if (val) {
          pv.textContent = val;
          pv.classList.remove('preview-empty');
        } else {
          pv.textContent = '';
          pv.classList.add('preview-empty');
        }
      }

      function updateEmailPreview() {
        const val = document.getElementById('email').value;
        const pv = document.getElementById('pv-email');
        if (!pv) return;

        if (val) {
          pv.textContent = val;
          pv.classList.remove('preview-empty');
        } else {
          pv.textContent = '';
          pv.classList.add('preview-empty');
        }
      }


      function updatePhoneContactPreview() {
        const val = document.getElementById('phoneContact').value;
        const pv = document.getElementById('pv-phone-contact');
        if (!pv) return;

        if (val) {
          pv.textContent = val;
          pv.classList.remove('preview-empty');
        } else {
          pv.textContent = '';
          pv.classList.add('preview-empty');
        }
      }

      function updateEmailContactPreview() {
        const val = document.getElementById('emailContact').value;
        const pv = document.getElementById('pv-email-contact');
        if (!pv) return;

        if (val) {
          pv.textContent = val;
          pv.classList.remove('preview-empty');
        } else {
          pv.textContent = '';
          pv.classList.add('preview-empty');
        }
      }


      /* ============================
        入力イベントまとめて捕まえる
        ============================ */
      document.addEventListener('input', (e) => {
        const id = e.target.id;

        // 郵便番号 自動ハイフン
        if (id === 'addressZipCurrent' || id === 'addressZipContact') {
          e.target.value = formatZip(e.target.value);
        }

        // 現住所系
        if (id.startsWith('address') && id.includes('Current')) {
          updateCurrentAddressPreview();

          // 「現住所と同一」がONなら、連絡先側も追従
          const check = document.getElementById('contactSameAsCurrent');
          if (check && check.checked) {
            updateContactAddress();
          }
        }

        // 連絡先系
        if (id.startsWith('address') && id.includes('Contact')) {
          updateContactAddress();
        }

        if (id === 'phone') updatePhonePreview();
        if (id === 'email') updateEmailPreview();
        if (id === 'phoneContact') updatePhoneContactPreview();
        if (id === 'emailContact') updateEmailContactPreview();
      });

      /* ============================
        初期化
        ============================ */
      initAddressSync();
      updateCurrentAddressPreview();
      updateContactAddress();
      updatePhonePreview();
      updateEmailPreview();
      updatePhoneContactPreview();
      updateEmailContactPreview();

      })();

      // ─────────────────────────
      // 学歴・職歴 → プレビュー（1ページ目15行 + 2ページ目7行）
      // ─────────────────────────
      (function () {
        const eduContainerSchool = document.getElementById('edu-container-school'); // 学歴
        const eduContainerWork   = document.getElementById('edu-container-work');   // 職歴
        const eduTemplate        = document.getElementById('edu-template');
        const eduPreviewBody1    = document.getElementById('edu-preview-body-page1'); // 1〜15行
        const eduPreviewBody2    = document.getElementById('edu-preview-body-page2'); // 16〜22行
        const addEduSchoolBtn    = document.getElementById('add-edu-school-btn');
        const addEduWorkBtn      = document.getElementById('add-edu-work-btn');

        if (
          !eduContainerSchool ||
          !eduContainerWork   ||
          !eduTemplate        ||
          !eduPreviewBody1    ||
          !eduPreviewBody2    ||
          !addEduSchoolBtn    ||
          !addEduWorkBtn
        ) return;

        // コンテナから行データを取得する共通関数
        function collectRows(container) {
          const result = [];
          const rows = container.querySelectorAll('.edu-row');
          rows.forEach((row) => {
            const year  = row.querySelector('.edu-year')?.value.trim()  || '';
            const month = row.querySelector('.edu-month')?.value.trim() || '';
            const text  = row.querySelector('.edu-text')?.value.trim()  || '';
            // 年・月・内容どれか1つでも入っていたら行として採用
            if (year || month || text) {
              result.push({ year, month, text });
            }
          });
          return result;
        }

        // プレビュー同期
        function syncEduPreview() {
          eduPreviewBody1.innerHTML = '';
          eduPreviewBody2.innerHTML = '';

          const schoolRows = collectRows(eduContainerSchool); // 学歴
          const workRows   = collectRows(eduContainerWork);   // 職歴

          const allRows = [];

          // ▼ 学歴が1つ以上あれば、先頭に「学歴」ラベル行
          if (schoolRows.length > 0) {
            allRows.push({ header: true, text: '学歴' });
            schoolRows.forEach((r) => allRows.push({ ...r, header: false }));
          }

          // ▼ 職歴が1つ以上あれば、その前に「職歴」ラベル行
          if (workRows.length > 0) {
            allRows.push({ header: true, text: '職歴' });
            workRows.forEach((r) => allRows.push({ ...r, header: false }));
          }

          // 1ページ目：0〜14番（15行）
          for (let i = 0; i < 15; i++) {
            const data = allRows[i] || { year: '', month: '', text: '', header: false };
            const tr = document.createElement('tr');

            if (data.header) {
              tr.classList.add('edu-header-row');
              tr.innerHTML = `
                <td></td>
                <td></td>
                <td>${data.text}</td>
              `;
            } else {
              tr.innerHTML = `
                <td>${data.year}</td>
                <td>${data.month}</td>
                <td>${data.text}</td>
              `;
            }

            eduPreviewBody1.appendChild(tr);
          }

          // 2ページ目：15〜21番（7行）
          for (let i = 15; i < 22; i++) {
            const data = allRows[i] || { year: '', month: '', text: '', header: false };
            const tr = document.createElement('tr');

            if (data.header) {
              tr.classList.add('edu-header-row');
              tr.innerHTML = `
                <td></td>
                <td></td>
                <td>${data.text}</td>
              `;
            } else {
              tr.innerHTML = `
                <td>${data.year}</td>
                <td>${data.month}</td>
                <td>${data.text}</td>
              `;
            }

            eduPreviewBody2.appendChild(tr);
          }
        }

        // 学歴の行を追加
        function addEduRowSchool() {
          const frag = eduTemplate.content.cloneNode(true);
          eduContainerSchool.appendChild(frag);
          syncEduPreview();
        }

        // 職歴の行を追加
        function addEduRowWork() {
          const frag = eduTemplate.content.cloneNode(true);
          eduContainerWork.appendChild(frag);
          syncEduPreview();
        }

        // 入力されたら都度プレビュー更新（イベント委譲）
        eduContainerSchool.addEventListener('input', (e) => {
          if (e.target.matches('.edu-year, .edu-month, .edu-text')) {
            syncEduPreview();
          }
        });

        eduContainerWork.addEventListener('input', (e) => {
          if (e.target.matches('.edu-year, .edu-month, .edu-text')) {
            syncEduPreview();
          }
        });

        // ボタン押下で行追加
        addEduSchoolBtn.addEventListener('click', addEduRowSchool);
        addEduWorkBtn.addEventListener('click', addEduRowWork);

        // 初期表示：学歴1行・職歴1行
        addEduRowSchool();
        addEduRowWork();
      })();



      // ─────────────────────────
      // 免許・資格 → プレビュー（6行固定）
      // ─────────────────────────
      (function () {
        const licContainer = document.getElementById('lic-container');
        const licTemplate = document.getElementById('lic-template');
        const licPreviewBody = document.getElementById('lic-preview-body');
        const addLicBtn = document.getElementById('add-lic-btn');

        if (!licContainer || !licTemplate || !licPreviewBody || !addLicBtn) return;

        function syncLicPreview() {
          licPreviewBody.innerHTML = '';

          const allRows = [];
          const rows = licContainer.querySelectorAll('.lic-row');
          rows.forEach((row) => {
            const year = row.querySelector('.lic-year')?.value.trim() || '';
            const month = row.querySelector('.lic-month')?.value.trim() || '';
            const text = row.querySelector('.lic-text')?.value.trim() || '';
            if (year || month || text) {
              allRows.push({ year, month, text });
            }
          });

          // 6行分だけ描画（足りない分は空行）
          for (let i = 0; i < 6; i++) {
            const data = allRows[i] || { year: '', month: '', text: '' };
            const tr = document.createElement('tr');
            tr.innerHTML = `
              <td>${data.year}</td>
              <td>${data.month}</td>
              <td>${data.text}</td>
            `;
            licPreviewBody.appendChild(tr);
          }
        }

        function addLicRow() {
          const frag = licTemplate.content.cloneNode(true);
          licContainer.appendChild(frag);
          syncLicPreview();
        }

        licContainer.addEventListener('input', (e) => {
          if (e.target.matches('.lic-year, .lic-month, .lic-text')) {
            syncLicPreview();
          }
        });

        addLicBtn.addEventListener('click', addLicRow);

        // 最初の1行
        addLicRow();
      })();



      // ─────────────────────────
      // 志望動機（チェックボックス → 自動生成 + テキスト → プレビュー）
      // ─────────────────────────
      (function () {
        const prTextarea = document.getElementById('prText');
        const pvPr = document.getElementById('pv-prText');
        const generateBtn = document.getElementById('generatePR');
        const options = document.querySelectorAll('.pr-option');

        function updatePreviewFromTextarea() {
          if (!prTextarea || !pvPr) return;
          const v = prTextarea.value.trim();
          if (v) {
            pvPr.textContent = v;
            pvPr.classList.remove('preview-empty');
          } else {
            pvPr.textContent = '（ここに志望動機が自動入力されます）';
            pvPr.classList.add('preview-empty');
          }
        }

        if (prTextarea) {
          prTextarea.addEventListener('input', updatePreviewFromTextarea);
          updatePreviewFromTextarea();
        }

        if (generateBtn) {
          generateBtn.addEventListener('click', () => {
            const sentences = [];
            options.forEach((opt) => {
              if (opt.checked) sentences.push(opt.value);
            });

            if (!sentences.length || !prTextarea) return;

            const text =
              'これまでの保育経験の中で、' +
              sentences.join(' ') +
              ' といった点を大切にしてまいりました。貴園でも子どもたち一人ひとりに寄り添いながら、保護者や職員の方々と協力し、安心して過ごせる環境づくりに貢献したいと考えております。';

            prTextarea.value = text;
            prTextarea.dispatchEvent(new Event('input'));
          });
        }
      })();

      // ─────────────────────────
      // 本人希望欄（チェックボックス → 自動入力 + テキスト → プレビュー）
      // ─────────────────────────
      (function () {
        const hopeTextarea = document.getElementById('hopeText');
        const pvHope = document.getElementById('pv-hopeText');
        const generateBtn = document.getElementById('generateHope');
        const options = document.querySelectorAll('.hope-option');

        function updatePreviewFromTextarea() {
          if (!hopeTextarea || !pvHope) return;
          const v = hopeTextarea.value.trim();
          if (v) {
            pvHope.textContent = v;
            pvHope.classList.remove('preview-empty');
          } else {
            pvHope.textContent = '（ここに本人希望欄の内容が入ります）';
            pvHope.classList.add('preview-empty');
          }
        }

        if (hopeTextarea) {
          hopeTextarea.addEventListener('input', updatePreviewFromTextarea);
          updatePreviewFromTextarea();
        }

        if (generateBtn) {
          generateBtn.addEventListener('click', () => {
            const parts = [];
            options.forEach((opt) => {
              if (opt.checked) parts.push(opt.value);
            });
            if (!parts.length || !hopeTextarea) return;

            const text = parts.join(' ') + ' 以上の内容について柔軟にご相談させていただけますと幸いです。';
            hopeTextarea.value = text;
            hopeTextarea.dispatchEvent(new Event('input'));
          });
        }
      })();

        // -------------- 写真アップロード → プレビュー反映 ----------------
      (function () {
        const input = document.getElementById("photo");
        const pvCell = document.querySelector(".jis-photo-cell");

        if (!input || !pvCell) return;

        input.addEventListener("change", function () {
          const file = input.files[0];
          if (!file) return;

          const reader = new FileReader();
          reader.onload = function (e) {
            // 既存の「写真（4×3cm）」テキストをクリア
            pvCell.innerHTML = "";

            // img を挿入
            const img = document.createElement("img");
            img.src = e.target.result;
            pvCell.appendChild(img);
          };
          reader.readAsDataURL(file);
        });
      })();

      // ─────────────────────────
      // プレビュー上部の日付（今日の日付を自動セット）
      // ─────────────────────────
      (function () {
        const dateEl = document.getElementById('pv-date');
        if (!dateEl) return;

        const d = new Date();
        const y = d.getFullYear();
        const m = d.getMonth() + 1;
        const day = d.getDate();
        dateEl.textContent = `${y}年${m}月${day}日現在`;
      })();

      // ───── PDF ダウンロード（履歴書：A3横1枚） ─────
      const resumeForm = document.getElementById('resume-form');
      const resumePdfButton = document.getElementById('btn-submit-resume');

      if (resumeForm && resumePdfButton) {
        resumeForm.addEventListener('submit', function (e) {
          e.preventDefault(); // サーバー送信を止める

          // A3横1枚レイアウトを画面外に一時生成
          const pdfContainer = createA3LayoutForPdf();
          if (!pdfContainer) {
            alert('PDFレイアウトの生成に失敗しました。');
            return;
          }

          const opt = {
            margin: 0,
            filename: 'rirekisyo.pdf',
            image: { type: 'jpeg', quality: 0.95 },
            html2canvas: { scale: 2, useCORS: true },
            jsPDF: {
              unit: 'pt',
              // A3横
              format: [1190.52, 841.92],
              orientation: 'landscape'
            }
          };

          html2pdf()
            .from(pdfContainer)
            .set(opt)
            .save()
            .then(() => {
              // 使い終わった一時コンテナを削除
              pdfContainer.remove();
            });
        });
      }

    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>


    <!-- PDF生成用の見えないコンテナ -->
    <div id="pdf-root" style="position:fixed; left:-9999px; top:-9999px;"></div>

  </body>
</html>
